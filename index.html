<!DOCTYPE html>
<html lang="pt">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Trabalho Web</title>
    <link rel="stylesheet" href="style2.css">
</head>
<body>

    

    <aside id="aside1">

        <section id="jog" >
            <div id="jog1"></div>
            <div id="pontJog">
                <div id="jr1"></div>
                <div id="jr2"></div>
                <div id="jr3"></div>
                <div id="totalJog"></div>
                
            </div>

        </section>

        <section id="inicio">

            <button onclick="Jog()">Jogar</button>
        </section>
    </aside>
    <main>

        <table class="tabela">

            <tbody>

                <tr>

                    <td id="bot1x1" onclick="valorBot('bot1x1', botAux)">

                    </td>
                    <td id="bot1x2" onclick="valorBot('bot1x2', botAux)">

                    </td>
                    <td id="bot1x3" onclick="valorBot('bot1x3', botAux)">
                        
                    </td>
                </tr>
                <tr>

                    <td id="bot2x1" onclick="valorBot('bot2x1', botAux)">

                    </td>
                    <td id="bot2x2" onclick="valorBot('bot2x2', botAux)">

                    </td>
                    <td id="bot2x3" onclick="valorBot('bot2x3', botAux)">
                        
                    </td>
                </tr>
                <tr>

                    <td id="bot3x1" onclick="valorBot('bot3x1', botAux)">

                    </td>
                    <td id="bot3x2" onclick="valorBot('bot3x2', botAux)">

                    </td>
                    <td id="bot3x3" onclick="valorBot('bot3x3', botAux)">

                    </td>
                </tr>
            </tbody>
        </table>

        <table class="tabela" onclick="Bot()">

            <tbody>

                <tr>

                    <td id="jog1x1" onclick="valorJog('jog1x1', jogAux)">

                    </td>
                    <td id="jog1x2" onclick="valorJog('jog1x2', jogAux)">

                    </td>
                    <td id="jog1x3" onclick="valorJog('jog1x3', jogAux)">
                        
                    </td>
                </tr>
                <tr>

                    <td id="jog2x1" onclick="valorJog('jog2x1', jogAux)">

                    </td>
                    <td id="jog2x2" onclick="valorJog('jog2x2', jogAux)">

                    </td>
                    <td id="jog2x3" onclick="valorJog('jog2x3', jogAux)">
                        
                    </td>
                </tr>
                <tr>

                    <td id="jog3x1" onclick="valorJog('jog3x1', jogAux)">

                    </td>
                    <td id="jog3x2" onclick="valorJog('jog3x2', jogAux)">

                    </td>
                    <td id="jog3x3" onclick="valorJog('jog3x3', jogAux)">

                    </td>
                </tr>
            </tbody>
        </table>
    </main>
    <aside id="aside2">

        <section id="bot">
                <div id="bot1"></div>
                <div id="pontBot">
                    <div id="br1"></div>
                    <div id="br2"></div>
                    <div id="br3"></div>
                    <div id="totalBot"></div>
                </div>

        </section>

        <section id="fim">

            <button onclick="Bot()">Jogar</button>
        </section>
    </aside>

    <script>

        let bot = [
            [0, 0, 0],
            [0, 0, 0],
            [0, 0, 0]
        ]


        let jog = [
            [0, 0, 0],
            [0, 0, 0],
            [0, 0, 0]
        ]

        let botAux = 0;
        let jogAux = 0;
        let pontoJog = 0;
        let pontoJog1 = 0;
        let pontoJog2 = 0;
        let pontoJog3 = 0;
        let pontoBot = 0;
        let pontoBot1 = 0;
        let pontoBot2 = 0;
        let pontoBot3 = 0;

        function Jog() {
            jogAux = Math.floor(Math.random() * 6) + 1;
            document.getElementById('jog1').innerText = jogAux
        }

        function Bot() {
            botAux = Math.floor(Math.random() * 6) + 1;
            document.getElementById('bot1').innerText = botAux
        }

        function valorBot(id, dado) {
            let linha = id.charAt(3);
            let coluna = id.charAt(5);
            if (bot[linha - 1][coluna - 1] == 0) {
                bot[linha - 1][coluna - 1] = dado;
            } else {
                return 0;
            }
            let idPreencher = 'bot' + linha + 'x' + coluna;
            document.getElementById(idPreencher).innerText = dado;
            zerarIguais(coluna-1);
            Bot();
            CalcPontosBot();
            //configurar delay
            ganhaJog();
        }

        function valorJog(id, dado) {
            let linha = id.charAt(3);
            let coluna = id.charAt(5);
            if (jog[linha - 1][coluna - 1] == 0) {
                jog[linha - 1][coluna - 1] = dado;
            } else {
                return 0;
            }
            let idPreencher = 'jog' + linha + 'x' + coluna;
            document.getElementById(idPreencher).innerText = dado;
            zerarIguais(coluna-1);
            Jog();
            CalcPontosJog();
            //configurar delay
            ganhaJog();
        }


        function CalcPontosJog()
        {
            pontoJog1=pontosJog(0);
            pontoJog2=pontosJog(1);
            pontoJog3=pontosJog(2);
            pontoJog=pontoJog1+pontoJog2+pontoJog3;
            document.getElementById('totalJog').innerText = pontoJog;
        }
        
        function pontosJog(col){
            let pontoJogCol = 0;
            for (let i = 0; i < 3; i++) {
                let valorrepetido = jog[i][col];
                let cont = 0;
                for (let j = 0; j < 3; j++) {
                    if (valorrepetido === jog[j][col]) {
                        cont++;
                    }
                }
                pontoJogCol = pontoJogCol + jog[i][col] * cont;
            }
            if (pontoJogCol == 0){
                return 0;
            }
            let idPreencher = 'jr' + (col+1);
            document.getElementById(idPreencher).innerText = pontoJogCol;
            return pontoJogCol;    
        }


        function CalcPontosBot()
        {
            pontoBot1=pontosBot(0);
            pontoBot2=pontosBot(1);
            pontoBot3=pontosBot(2);
            pontoBot=pontoBot1+pontoBot2+pontoBot3;
            document.getElementById('totalBot').innerText = pontoBot;
        }
        
        function pontosBot(col){
            let pontoBotCol = 0;
            for (let i = 0; i < 3; i++) {
                let valorrepetido = bot[i][col];
                let cont = 0;
                for (let j = 0; j < 3; j++) {
                    if (valorrepetido === bot[j][col]) {
                        cont++;
                    }
                }
                pontoBotCol = pontoBotCol + bot[i][col] * cont;
            }
            if (pontoBotCol == 0){
                return 0;
            }
            let idPreencher = 'br' + (col+1);
            document.getElementById(idPreencher).innerText = pontoBotCol;
            return pontoBotCol;    
        }

        function ganhaJog() {
            let contJog = 0;
            let contBot = 0;
            for (let i = 0; i < 3; i++) {
                for (let j = 0; j < 3; j++) {
                    if (jog[i][j] !== 0) {
                        contJog++;
                    }
                    if (bot[i][j] !== 0) {
                        contBot++;
                    }
                }
            }
            if ((contJog === 9) || (contBot === 9)) {
                jogPontVerif();
            }
        }

        function jogPontVerif() {
            if (pontoJog > pontoBot) {
                alert("Jogador 1 Ganhou");
            } else if (pontoJog < pontoBot) {
                alert("Jogador 2 Ganhou");
            } else {
                alert("Empate");
            }
        }

        function zerarIguais(col){
            for (let i=0;i<3;i++){
                for (let j=0;j<3;j++){
                    if (jog[i][col] !== 0 && (jog[i][col] == bot[j][col])){
                        valorComp = jog[i][col];
                        for (let k=0;k<3;k++){
                            for (let l=0;l<3;l++){
                                if (jog[k][l] == valorComp){
                                    jog[k][l] = 0;
                                    let idJogApagar = 'jog'+(k+1)+'x'+(l+1);
                                    document.getElementById(idJogApagar).innerText = '';
                                }
                                if (bot[k][l] == valorComp){
                                    bot[k][l] = 0;
                                    let idBotApagar = 'bot'+(k+1)+'x'+(l+1);
                                    document.getElementById(idBotApagar).innerText = '';
                                }
                            }
                        }
                    }
                }
            }
        }        

    </script>
    
</body>
</html>